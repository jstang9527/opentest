package views

import (
	"io/ioutil"
	"net/http"

	"github.com/jstang9527/opentest/conf"
)

//Todo ...
type Todo struct {
	Task string
	Done bool
}

// IndexRequest ...
func IndexRequest(w http.ResponseWriter, r *http.Request) {
	filePath := conf.FRONTENDPATH + "index.html"
	defer func() {
		if err := recover(); err != nil {
			DialLog(r, 500)
			w.Write([]byte(`<h1 style="color:red;text-align:center">500 服务器错误</h1>`))
		}
	}()

	// 可能会出错(文件找不到、文件渲染失败等)
	// tmpl := template.Must(template.ParseFiles(filePath))
	// todos := []Todo{
	// 	{"Learn Go", true},
	// 	{"Read Go Web Examples", true},
	// 	{"Create a web app in Go", false},
	// }
	// tmpl.Execute(w, struct{ Todos []Todo }{todos})
	b, _ := ioutil.ReadFile(filePath)
	w.Write(b)
	DialLog(r, 200)
}
