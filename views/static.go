package views

import (
	"io/ioutil"
	"net/http"
	"strings"

	"github.com/jstang9527/opentest/conf"
)

// IconRequest ...
func IconRequest(w http.ResponseWriter, r *http.Request) {
	filePath := conf.FRONTENDPATH + "images/favicon.ico"
	if b, err := ioutil.ReadFile(filePath); err != nil {
		DialLog(r, 404)
	} else {
		w.Write(b)
		DialLog(r, 200)
	}
}

// StaticRequest 静态资源获取img、css、js、other
func StaticRequest(w http.ResponseWriter, r *http.Request) {
	index := strings.Index(r.RequestURI[1:], "/")
	filePath := conf.FRONTENDPATH + r.RequestURI[index+2:]
	if b, err := ioutil.ReadFile(filePath); err != nil {
		DialLog(r, 404)
	} else {
		w.Write(b)
		DialLog(r, 200)
	}
}

// ResourcesRequest ...
func ResourcesRequest(w http.ResponseWriter, r *http.Request) {
	index := strings.Index(r.RequestURI[1:], "/")
	filePath := conf.RESOURCES + r.RequestURI[index+2:]
	if b, err := ioutil.ReadFile(filePath); err != nil {
		DialLog(r, 404)
	} else {
		w.Write(b)
		DialLog(r, 200)
	}
}
