package es

import (
	"fmt"

	"github.com/olivere/elastic/v7"
)

var client *elastic.Client
var index string //索引,相当于数据库
var ch chan *TestItem

// InitES 初始化
func InitES(esip, esindex string, esport, chansize, nums int) (err error) {
	url := fmt.Sprintf("http://%s:%d", esip, esport)
	client, err = elastic.NewClient(elastic.SetURL(url))
	if err != nil {
		return
	}
	index = esindex
	// 通道初始化
	ch = make(chan *TestItem, chansize)
	// PushES异步协程数量
	for i := 0; i < nums; i++ {
		go sendToES()
	}
	return
}
