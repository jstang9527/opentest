package msploit

// ModulesPayloadsReq ...
type ModulesPayloadsReq struct {
	_msgpack   struct{} `msgpack:",asArray"`
	Method     string
	Token      string
	ModuleName string
}

// ModulesPayloadsRes ...
type ModulesPayloadsRes struct {
	Payloads []string `msgpack:"payloads"`
}

// ShowModulesPayloads ...
// module.info方法返回有关指定模块的详细信息的哈希。
// ModuleType应该是“ exploit”，“ auxiliary”，“ post”，“ payload”，“ encoder”和“ nop”之一。
// ModuleName可以包含模块类型前缀（exploit/），也可以不包含。exploit/windows/smb/ms08_067_netapi
func (msf *Metasploit) ShowModulesPayloads(moduletype, modulename string) (res ModulesPayloadsRes, err error) {
	ctx := &ModulesPayloadsReq{
		Method:     "module.compatible_payloads",
		Token:      msf.token,
		ModuleName: modulename, // "exploit/windows/smb/ms08_067_netapi",
	}

	err = msf.send(ctx, &res)
	return res, err
}
